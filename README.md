# PCAPNG HTTPS Domain Extractor

–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è HTTPS –¥–æ–º–µ–Ω–æ–≤ –∏–∑ —Ñ–∞–π–ª–æ–≤ –∑–∞—Ö–≤–∞—Ç–∞ —Å–µ—Ç–µ–≤–æ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞ (PCAPNG) —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Python –∏ Wireshark.

## üìã –û–ø–∏—Å–∞–Ω–∏–µ

–≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Ñ–∞–π–ª—ã PCAPNG (—Å–æ–∑–¥–∞–Ω–Ω—ã–µ Wireshark –∏–ª–∏ –¥—Ä—É–≥–∏–º–∏ —Å–µ—Ç–µ–≤—ã–º–∏ –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä–∞–º–∏) –∏ –∏–∑–≤–ª–µ–∫–∞–µ—Ç –∏–∑ –Ω–∏—Ö —Ç–æ–ª—å–∫–æ —á–∏—Å—Ç—ã–µ –¥–æ–º–µ–Ω–Ω—ã–µ –∏–º–µ–Ω–∞ HTTPS-—Å–∞–π—Ç–æ–≤. –°–∫—Ä–∏–ø—Ç —Ñ–∏–ª—å—Ç—Ä—É–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã, —É–±–∏—Ä–∞—è HTTP-–∞–¥—Ä–µ—Å–∞, IP-–∞–¥—Ä–µ—Å–∞, –ª–æ–∫–∞–ª—å–Ω—ã–µ –∞–¥—Ä–µ—Å–∞ –∏ –ø—É—Ç–∏ –ø–æ—Å–ª–µ –¥–æ–º–µ–Ω–Ω–æ–≥–æ –∏–º–µ–Ω–∏.

### –ß—Ç–æ –¥–µ–ª–∞–µ—Ç —Å–∫—Ä–∏–ø—Ç:

- ‚úÖ –ò–∑–≤–ª–µ–∫–∞–µ—Ç —Ç–æ–ª—å–∫–æ HTTPS –¥–æ–º–µ–Ω—ã (HTTP –∏–≥–Ω–æ—Ä–∏—Ä—É—é—Ç—Å—è)
- ‚úÖ –£–±–∏—Ä–∞–µ—Ç –ø—É—Ç–∏ –ø–æ—Å–ª–µ –¥–æ–º–µ–Ω–Ω–æ–≥–æ –∏–º–µ–Ω–∏ (`example.com/path` ‚Üí `example.com`)
- ‚úÖ –ò—Å–∫–ª—é—á–∞–µ—Ç IP-–∞–¥—Ä–µ—Å–∞ (`192.168.1.1`, `2001:db8::1`)
- ‚úÖ –§–∏–ª—å—Ç—Ä—É–µ—Ç –ª–æ–∫–∞–ª—å–Ω—ã–µ –∞–¥—Ä–µ—Å–∞ (`localhost`, `192.168.x.x`, `10.x.x.x`)
- ‚úÖ –£–¥–∞–ª—è–µ—Ç –¥—É–±–ª–∏–∫–∞—Ç—ã –∏ —Å–æ—Ä—Ç–∏—Ä—É–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–º–µ–Ω—É–µ—Ç –≤—ã—Ö–æ–¥–Ω—ã–µ —Ñ–∞–π–ª—ã
- ‚úÖ –°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ –æ—Ç–¥–µ–ª—å–Ω—É—é –ø–∞–ø–∫—É

## üîß –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

### –°–∏—Å—Ç–µ–º–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è:

- Python 3.6+
- Wireshark (–≤–∫–ª—é—á–∞–µ—Ç tshark)

### Python –±–∏–±–ª–∏–æ—Ç–µ–∫–∏:

- `pyshark` - –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ PCAPNG —Ñ–∞–π–ª–æ–≤

## üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Wireshark

**Windows:**

1. –°–∫–∞—á–∞–π—Ç–µ Wireshark —Å [–æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–≥–æ —Å–∞–π—Ç–∞](https://www.wireshark.org/download.html)
2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ `.exe` —Ñ–∞–π–ª
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—ã–±—Ä–∞–Ω–∞ –æ–ø—Ü–∏—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ `tshark`

**Linux (Ubuntu/Debian):**

```bash
sudo apt update
sudo apt install wireshark tshark
```

**Linux (CentOS/RHEL):**

```bash
sudo yum install wireshark wireshark-cli
# –∏–ª–∏ –¥–ª—è –Ω–æ–≤—ã—Ö –≤–µ—Ä—Å–∏–π:
sudo dnf install wireshark wireshark-cli
```

**macOS:**

```bash
# –ß–µ—Ä–µ–∑ Homebrew
brew install wireshark
```

### 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ tshark

```bash
tshark --version
```

### 3. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Python –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

**–ì–ª–æ–±–∞–ª—å–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞:**

```bash
pip install pyshark
```

**–ò–ª–∏ —Å–æ–∑–¥–∞–Ω–∏–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è):**

```bash
# –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è
python -m venv venv

# –ê–∫—Ç–∏–≤–∞—Ü–∏—è –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è
# Linux/macOS:
source venv/bin/activate
# Windows:
venv\Scripts\activate

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
pip install pyshark
```

## üì• –ü–æ–ª—É—á–µ–Ω–∏–µ `.pcapng` —Ñ–∞–π–ª–∞ –Ω–∞ —Ä–æ—É—Ç–µ—Ä–µ Keenetic

–ß—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å `.pcapng` —Ñ–∞–π–ª —Å —Ä–æ—É—Ç–µ—Ä–∞ Keenetic –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –≤ Wireshark:

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å Keenetic
2. –û—Ç–∫—Ä–æ–π—Ç–µ —Ä–∞–∑–¥–µ–ª **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ ‚Üí –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ ‚Üí –ó–∞—Ö–≤–∞—Ç —Å–µ—Ç–µ–≤—ã—Ö –ø–∞–∫–µ—Ç–æ–≤**

<img width="1375" alt="image" src="https://github.com/user-attachments/assets/47d8722b-604d-422c-a10e-8fbd70d47482" />


3. –°–æ–∑–¥–∞–π—Ç–µ –ø—Ä–∞–≤–∏–ª–æ, –Ω–∞–∂–∞–≤ –∫–Ω–æ–ø–∫—É **–î–æ–±–∞–≤–∏—Ç—å –ø—Ä–∞–≤–∏–ª–æ –∑–∞—Ö–≤–∞—Ç–∞**, –≤—ã–±–µ—Ä–∏—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ, —á–µ—Ä–µ–∑ –∫–æ—Ç–æ—Ä–æ–µ —Ö–æ—Ç–∏—Ç–µ —Å–æ–±—Ä–∞—Ç—å –∞–¥—Ä–µ—Å–∞ –∏ –≤—ã–±–µ—Ä–µ—Ç–µ, –∫—É–¥–∞ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å —Ñ–∞–π–ª
4. –í –≤—ã–ø–∞–¥–∞—é—â–µ–º —Å–ø–∏—Å–∫–µ **–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ** –≤—ã–±–µ—Ä–∏—Ç–µ –Ω—É–∂–Ω–æ–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `PPPoE0`), —á–µ—Ä–µ–∑ –∫–æ—Ç–æ—Ä–æ–µ —Ö–æ—Ç–∏—Ç–µ —Å–æ–±—Ä–∞—Ç—å –∞–¥—Ä–µ—Å–∞ –∏ –≤—ã–±–µ—Ä–µ—Ç–µ
5. –ù—É–∂–Ω–æ –≤—ã–±—Ä–∞—Ç—å —Ñ–ª–µ—à–∫—É –∫–∞–∫ –º–µ—Å—Ç–æ—Å —Å–æ—Ö—Ä–∞—Ä–µ–Ω–∏—è –≤ –ø–æ–ª–µ **–ú–µ—Å—Ç–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è**, —Ç–∞–∫ –∫–∞–∫ —Ñ–∞–π–ª –º–æ–∂–µ—Ç–±—ã—Ç—å –±–æ–ª—å—à–µ 100–º–±
6. –ù–∞–∂–º–∏—Ç–µ **–°–æ—Ö—Ä–∞–Ω–∏—Ç—å**

<img width="502" alt="image" src="https://github.com/user-attachments/assets/b66b4270-cd07-4059-aae7-159bbb46e7bb" />


7. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É **–ó–∞–ø—É—Å—Ç–∏—Ç—å**
8. –û—Ç–∫—Ä—ã–≤–∞–π—Ç–µ —Å–∞–π—Ç—ã, —Å –∫–æ—Ç–æ—Ä—ã—Ö —Ö–æ—Ç–∏—Ç–µ —Å–æ–±—Ä–∞—Ç—å –∞–¥—Ä–µ—Å–∞ (–Ω–∞ –∫–æ–º–ø—å—é—Ç–µ—Ä–µ, —Ç–µ–ª–µ–≤–∏–∑–æ–≤–µ, —Ç–µ–ª–µ—Ñ–æ–Ω–µ)
9. –ß–µ—Ä–µ–∑ –Ω–µ–∫–æ—Ç–æ—Ä–æ–µ –≤—Ä–µ–º—è –Ω–∞–∂–º–∏—Ç–µ **–û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å**
10. –°–∫–∞—á–∞–π—Ç–µ –ø–æ–ª—É—á–µ–Ω–Ω—ã–π `.pcapng` —Ñ–∞–π–ª –Ω–∞ –∫–æ–º–ø—å—é—Ç–µ—Ä

–¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ç–æ—Ç —Ñ–∞–π–ª —Å –¥–∞–Ω–Ω—ã–º –ø—Ä–æ–µ–∫—Ç–æ–º –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ URL –∏ –¥–æ–º–µ–Ω–æ–≤.

## üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –û—Å–Ω–æ–≤–Ω–æ–π —Å–∫—Ä–∏–ø—Ç

```bash
python main.py <–ø—É—Ç—å_–∫_pcapng_—Ñ–∞–π–ª—É>
```

**–ü—Ä–∏–º–µ—Ä—ã:**

```bash
# –ü—Ä–æ—Å—Ç–æ–π –ø—Ä–∏–º–µ—Ä
python main.py capture.pcapng

# –§–∞–π–ª —Å –ø—Ä–æ–±–µ–ª–∞–º–∏ –≤ –∏–º–µ–Ω–∏
python main.py "capture-PPPoE0-Jun 5 16-16-32.pcapng"

# –ü–æ–ª–Ω—ã–π –ø—É—Ç—å –∫ —Ñ–∞–π–ª—É
python main.py /path/to/network-capture.pcapng
```

### –î–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏–π —Å–∫—Ä–∏–ø—Ç

–î–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ PCAPNG —Ñ–∞–π–ª–∞ –∏ –ø–æ–∏—Å–∫–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –¥–æ–º–µ–Ω–æ–≤:

```bash
python diagnostic.py <–ø—É—Ç—å_–∫_pcapng_—Ñ–∞–π–ª—É> [–¥–æ–º–µ–Ω—ã_–¥–ª—è_–ø–æ–∏—Å–∫–∞]
```

**–ü—Ä–∏–º–µ—Ä—ã:**

```bash
# –ü–æ–∏—Å–∫ YouTube-—Å–≤—è–∑–∞–Ω–Ω—ã—Ö –¥–æ–º–µ–Ω–æ–≤ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
python diagnostic.py capture.pcapng

# –ü–æ–∏—Å–∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –¥–æ–º–µ–Ω–æ–≤
python diagnostic.py capture.pcapng google.com facebook.com

# –ü–æ–∏—Å–∫ –¥–æ–º–µ–Ω–æ–≤ —Å–æ–¥–µ—Ä–∂–∞—â–∏—Ö –ø–æ–¥—Å—Ç—Ä–æ–∫–∏
python diagnostic.py capture.pcapng googlevideo ytimg ggpht
```

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
pcapng-extractor/
‚îú‚îÄ‚îÄ main.py              # –û—Å–Ω–æ–≤–Ω–æ–π —Å–∫—Ä–∏–ø—Ç –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –¥–æ–º–µ–Ω–æ–≤
‚îú‚îÄ‚îÄ diagnostic.py        # –î–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏–π —Å–∫—Ä–∏–ø—Ç –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
‚îú‚îÄ‚îÄ results/            # –ü–∞–ø–∫–∞ —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ (—Å–æ–∑–¥–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
‚îÇ   ‚îî‚îÄ‚îÄ urls-*.txt      # –§–∞–π–ª—ã —Å –∏–∑–≤–ª–µ—á–µ–Ω–Ω—ã–º–∏ –¥–æ–º–µ–Ω–∞–º–∏
‚îú‚îÄ‚îÄ venv/               # –í–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
‚îî‚îÄ‚îÄ README.md           # –≠—Ç–æ—Ç —Ñ–∞–π–ª
```

## üìÑ –§–æ—Ä–º–∞—Ç –≤—ã—Ö–æ–¥–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤

### –ò–º–µ–Ω–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤

–í—ã—Ö–æ–¥–Ω—ã–µ —Ñ–∞–π–ª—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–º–µ–Ω—É—é—Ç—Å—è –ø–æ —à–∞–±–ª–æ–Ω—É:

```
results/urls-{–∏—Å—Ö–æ–¥–Ω–æ–µ_–∏–º—è_—Ñ–∞–π–ª–∞}.txt
```

**–ü—Ä–∏–º–µ—Ä—ã:**

- `capture.pcapng` ‚Üí `results/urls-capture.txt`
- `network-trace-2024.pcapng` ‚Üí `results/urls-network-trace-2024.txt`

### –°–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞

```
HTTPS –¥–æ–º–µ–Ω—ã –∏–∑ —Ñ–∞–π–ª–∞: capture.pcapng
–í—Å–µ–≥–æ –Ω–∞–π–¥–µ–Ω–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –¥–æ–º–µ–Ω–æ–≤: 25
==================================================

facebook.com
google.com
instagram.com
stackoverflow.com
youtube.com
```

## üîç –ü—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã

–°–∫—Ä–∏–ø—Ç –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Ç—Ä–∏ –æ—Å–Ω–æ–≤–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –¥–æ–º–µ–Ω–æ–≤ –≤ —Å–µ—Ç–µ–≤–æ–º —Ç—Ä–∞—Ñ–∏–∫–µ:

### 1. HTTP –∑–∞–≥–æ–ª–æ–≤–∫–∏

- `Host` –∑–∞–≥–æ–ª–æ–≤–∫–∏ –∏–∑ HTTP –∑–∞–ø—Ä–æ—Å–æ–≤
- `Referer` –∑–∞–≥–æ–ª–æ–≤–∫–∏
- –ù–æ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —ç—Ç–æ HTTPS —Ç—Ä–∞—Ñ–∏–∫

### 2. TLS/SSL SNI (Server Name Indication)

- –î–æ–º–µ–Ω–Ω—ã–µ –∏–º–µ–Ω–∞ –∏–∑ TLS handshake
- –ù–∞–∏–±–æ–ª–µ–µ –Ω–∞–¥–µ–∂–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –¥–ª—è HTTPS —Ç—Ä–∞—Ñ–∏–∫–∞

### 3. DNS –∑–∞–ø—Ä–æ—Å—ã

- –ó–∞–ø—Ä–æ—Å—ã –∫ DNS —Å–µ—Ä–≤–µ—Ä–∞–º
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–∞–∫–∏–µ –¥–æ–º–µ–Ω—ã —Ä–µ–∑–æ–ª–≤–∏–ª–∏—Å—å

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏

### –ò—Å–∫–ª—é—á–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:

- **HTTP –∞–¥—Ä–µ—Å–∞** (`http://example.com`)
- **IP-–∞–¥—Ä–µ—Å–∞** (`192.168.1.1`, `2001:db8::1`)
- **–õ–æ–∫–∞–ª—å–Ω—ã–µ –∞–¥—Ä–µ—Å–∞**:
  - `localhost`
  - `127.x.x.x`
  - `192.168.x.x`
  - `10.x.x.x`
  - `172.16.x.x` - `172.31.x.x`
- **–ü—É—Ç–∏ –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã** (`example.com/path?param=value`)
- **–ü–æ—Ä—Ç—ã** (`example.com:8080`)

### –°–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è —Ç–æ–ª—å–∫–æ:

- ‚úÖ –í–∞–ª–∏–¥–Ω—ã–µ –¥–æ–º–µ–Ω–Ω—ã–µ –∏–º–µ–Ω–∞
- ‚úÖ HTTPS —Ç—Ä–∞—Ñ–∏–∫
- ‚úÖ –í–Ω–µ—à–Ω–∏–µ (–Ω–µ –ª–æ–∫–∞–ª—å–Ω—ã–µ) –∞–¥—Ä–µ—Å–∞

## üêõ –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º

### –ï—Å–ª–∏ –¥–æ–º–µ–Ω—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã:

1. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏–π —Å–∫—Ä–∏–ø—Ç:**

   ```bash
   python diagnostic.py your-file.pcapng domain-to-find.com
   ```

2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞ –≤ Wireshark:**

   - –û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª –≤ Wireshark
   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ñ–∏–ª—å—Ç—Ä—ã: `http.host`, `tls.handshake.extensions_server_name`, `dns.qry.name`

3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞:**
   ```bash
   # Linux/macOS - –º–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å—Å—è –¥–æ–±–∞–≤–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –≥—Ä—É–ø–ø—É wireshark
   sudo usermod -a -G wireshark $USER
   ```

### –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:

**ModuleNotFoundError: No module named 'pyshark'**

```bash
# –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–æ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
source venv/bin/activate
pip install pyshark
```

**tshark not found**

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —É—Å—Ç–∞–Ω–æ–≤–∫—É Wireshark
tshark --version
# –ï—Å–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω, –ø–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Wireshark
```

**–§–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω**

```bash
# –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–∞–≤—ã—á–∫–∏ –¥–ª—è —Ñ–∞–π–ª–æ–≤ —Å –ø—Ä–æ–±–µ–ª–∞–º–∏
python main.py "file with spaces.pcapng"
# –ò–ª–∏ –ø–æ–ª–Ω—ã–π –ø—É—Ç—å
python main.py /full/path/to/file.pcapng
```

## üìä –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ê–Ω–∞–ª–∏–∑ –¥–æ–º–∞—à–Ω–µ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞

```bash
# –ó–∞—Ö–≤–∞—Ç —Ç—Ä–∞—Ñ–∏–∫–∞ –Ω–∞ —Ä–æ—É—Ç–µ—Ä–µ Keenetic
# –≠–∫—Å–ø–æ—Ä—Ç –≤ PCAPNG —á–µ—Ä–µ–∑ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
python main.py home-traffic-2024-06-05.pcapng
```

### –ê–Ω–∞–ª–∏–∑ —Ç—Ä–∞—Ñ–∏–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

```bash
# –ó–∞—Ö–≤–∞—Ç —Ç—Ä–∞—Ñ–∏–∫–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
python main.py app-traffic.pcapng

# –ü–æ–∏—Å–∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –¥–æ–º–µ–Ω–æ–≤
python diagnostic.py app-traffic.pcapng api.service.com
```

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ YouTube —Ç—Ä–∞—Ñ–∏–∫–∞

```bash
# –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ YouTube –¥–æ–º–µ–Ω–æ–≤
python diagnostic.py youtube-session.pcapng googlevideo ytimg ggpht
```

## ü§ù –í–∫–ª–∞–¥ –≤ –ø—Ä–æ–µ–∫—Ç

1. –§–æ—Ä–∫–Ω–∏—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
2. –°–æ–∑–¥–∞–π—Ç–µ –≤–µ—Ç–∫—É –¥–ª—è –Ω–æ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ (`git checkout -b feature/amazing-feature`)
3. –ó–∞—Ñ–∏–∫—Å–∏—Ä—É–π—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è (`git commit -m 'Add amazing feature'`)
4. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –≤ –≤–µ—Ç–∫—É (`git push origin feature/amazing-feature`)
5. –û—Ç–∫—Ä–æ–π—Ç–µ Pull Request

## üìù –õ–∏—Ü–µ–Ω–∑–∏—è

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è–µ—Ç—Å—è –ø–æ–¥ –ª–∏—Ü–µ–Ω–∑–∏–µ–π MIT. –°–º. —Ñ–∞–π–ª `LICENSE` –¥–ª—è –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–µ–π.

## üîó –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

- [Wireshark Download](https://www.wireshark.org/download.html)
- [PyShark Documentation](https://kiminewt.github.io/pyshark/)
- [PCAPNG Format Specification](https://tools.ietf.org/html/draft-tuexen-opsawg-pcapng-02)
- [Keenetic Router Manual](https://help.keenetic.com/)

## ‚ùì FAQ

**Q: –ü–æ—á–µ–º—É —Å–∫—Ä–∏–ø—Ç –Ω–∞—Ö–æ–¥–∏—Ç –Ω–µ –≤—Å–µ –¥–æ–º–µ–Ω—ã?**
A: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏–π —Å–∫—Ä–∏–ø—Ç –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞. –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –¥–æ–º–µ–Ω—ã –º–æ–≥—É—Ç –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å—Å—è —á–µ—Ä–µ–∑ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –∏–ª–∏ –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –ø—Ä–æ—Ç–æ–∫–æ–ª—ã.

**Q: –ú–æ–∂–Ω–æ –ª–∏ –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ñ–∞–π–ª—ã .pcap?**
A: –î–∞, PyShark –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –æ–±–∞ —Ñ–æ—Ä–º–∞—Ç–∞ - .pcap –∏ .pcapng.

**Q: –ö–∞–∫ —É—Å–∫–æ—Ä–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤?**
A: –†–∞—Å—Å–º–æ—Ç—Ä–∏—Ç–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Ä–∞–∑–±–∏–µ–Ω–∏—è –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤ –Ω–∞ —á–∞—Å—Ç–∏ –∏–ª–∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ —Ç—Ä–∞—Ñ–∏–∫–∞ –≤ Wireshark –ø–µ—Ä–µ–¥ —ç–∫—Å–ø–æ—Ä—Ç–æ–º.

**Q: –ë–µ–∑–æ–ø–∞—Å–Ω–æ –ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–∫—Ä–∏–ø—Ç?**
A: –°–∫—Ä–∏–ø—Ç —Ç–æ–ª—å–∫–æ —á–∏—Ç–∞–µ—Ç —Ñ–∞–π–ª—ã –∑–∞—Ö–≤–∞—Ç–∞ –∏ –Ω–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Å–µ—Ç–µ–≤—ã—Ö –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π. –û–¥–Ω–∞–∫–æ –±—É–¥—å—Ç–µ –æ—Å—Ç–æ—Ä–æ–∂–Ω—ã —Å —Ñ–∞–π–ª–∞–º–∏ –∏–∑ –Ω–µ–¥–æ–≤–µ—Ä–µ–Ω–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤.
